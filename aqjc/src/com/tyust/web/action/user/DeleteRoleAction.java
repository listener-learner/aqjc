/*
 * Generated by MyEclipse Struts
 * Template path: templates/java/JavaClass.vtl
 */
package com.tyust.web.action.user;

import java.io.PrintWriter;

import javax.servlet.http.HttpServletRequest;

import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;
import org.apache.struts2.ServletActionContext;

import com.tyust.bean.user.TBaseUserInfo;
import com.tyust.common.OpertionType;
import com.tyust.common.SaveLog;
import com.tyust.service.user.RoleService;

/** 
 * MyEclipse Struts
 * Creation date: 07-14-2010
 * 
 * XDoclet definition:
 * @struts.action validate="true"
 */
public class DeleteRoleAction{
	/*
	 * Generated Methods
	 */
	//角色服务层接口
	private RoleService roleService;
	
	public RoleService getRoleService() {
		return roleService;
	}
	public void setRoleService(RoleService roleService) {
		this.roleService = roleService;
	}
	private static final Log logger = LogFactory.getLog(DeleteRoleAction.class);
	/** 
	 * Method execute
	 */
	public String execute() throws Exception{
		HttpServletRequest request=ServletActionContext.getRequest();
		String ids=request.getParameter("ids").trim();
		 int del=0;
		 logger.debug("删除："+ids);//roleIds[i]
		  del=roleService.deleteRole(ids);//roleIds[i]
		logger.debug("del:"+del);
			 if(del==0){
				SaveLog.saveLog(request, "删除角色", OpertionType.State.DELETE, "删除时角色下有用户，删除失败");
				request.setAttribute("message", "删除失败，该角色已分配有用户！");
				return "input";
			   }
			 else{
				roleService.deleteRoleModule(ids);
				SaveLog.saveLog(request, "删除角色", OpertionType.State.DELETE, "删除成功");
				request.setAttribute("success", true);
				request.setAttribute("message", "删除成功！");
				return "success";
			   }
		  
	}
}